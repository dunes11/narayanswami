{"version":3,"names":["this","ew","maps","exports","accessToken","adjustTileLayerOptions","options","detectRetina","window","devicePixelRatio","screen","deviceXDPI","logicalXDPI","width","hdWidth","maxZoom","opts","Object","assign","tileSize","Math","floor","zoomReverse","zoomOffset","minZoom","max","createBounds","L","latLngBounds","createLatLng","latitude","longitude","latLng","createMap","el","data","dataset","ext","urlTemplate","tileLayerOptions","map","mapOptions","zoom","center","latlng","service","mapboxSettings","openstreetmapSettings","tileLayer","addTo","createMarker","marker","markerOptions","title","String","icon","setIcon","iconUrl","desc","description","trim","bindPopup","openPopup","useMarkerClusterer","markerClusterer","addLayer","useSingleMap","showAllMarkers","bounds","extend","createMarkerClusterer","markerClusterGroup","markerClustererOptions","fitBounds","geocode","mapbox","settings","fetch","geocodeUrlTemplate","replace","encodeURIComponent","address","then","res","json","_data$features","features","length","reverse","parseFloat","lat","lon","attribution","id","defineProperty","value","leaflet"],"sources":["js\\ewleaflet.js"],"sourcesContent":["/*!\n * Leaflet for PHPMaker v2023.11.0\n * Copyright (c) e.World Technology Limited. All rights reserved.\n */\nthis.ew = this.ew || {};\nthis.ew.maps = this.ew.maps || {};\n(function (exports) {\n  'use strict';\n\n  /**\r\n   * Mapbox access token\r\n   */\r\n  var accessToken = \"\";\r\n\r\n  /**\r\n   * Settings for Mapbox\r\n   */\r\n  var mapboxSettings = {\r\n    urlTemplate: \"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\",\r\n    tileLayerOptions: {\r\n      attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, Imagery Â© <a href=\"https://www.mapbox.com/\">Mapbox</a>',\r\n      maxZoom: 18,\r\n      id: \"mapbox/streets-v11\",\r\n      tileSize: 512,\r\n      zoomOffset: -1,\r\n      detectRetina: true\r\n    },\r\n    geocodeUrlTemplate: \"https://api.mapbox.com/geocoding/v5/mapbox.places/{q}.json?limit=1&access_token={accessToken}\" // See https://docs.mapbox.com/help/tutorials/local-search-geocoding-api/\r\n  };\r\n\r\n  /**\r\n   * Settings for OpenStreetMap\r\n   */\r\n  var openstreetmapSettings = {\r\n    urlTemplate: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\r\n    tileLayerOptions: {\r\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n      maxZoom: 18,\r\n      minZoom: 0,\r\n      tileSize: 512,\r\n      zoomOffset: -1,\r\n      detectRetina: true\r\n    },\r\n    geocodeUrlTemplate: \"https://nominatim.openstreetmap.org/search?format=json&limit=1&q={q}\" // See https://nominatim.org/release-docs/develop/api/Search/\r\n  };\r\n\r\n  /**\r\n   * HD width\r\n   */\r\n  var hdWidth = 1920;\r\n\r\n  /**\r\n   * Default map options (see https://leafletjs.com/reference-1.7.1.html#map-option)\r\n   */\r\n  var mapOptions = {};\r\n\r\n  /**\r\n   * Default marker options (see https://leafletjs.com/reference-1.7.1.html#marker)\r\n   */\r\n  var markerOptions = {};\r\n\r\n  /**\r\n   * Default marker clusterer options (see https://github.com/Leaflet/Leaflet.markercluster#options)\r\n   */\r\n  var markerClustererOptions = {};\r\n\r\n  /**\r\n   * Send geocode requests\r\n   * @param {Object} data Map data\r\n   * @returns Promise\r\n   */\r\n  function geocode(data) {\r\n    let mapbox = data.service == \"mapbox\",\r\n      settings = mapbox ? this.mapboxSettings : this.openstreetmapSettings;\r\n    return fetch(settings.geocodeUrlTemplate.replace(\"{q}\", encodeURIComponent(data.address)).replace(\"{accessToken}\", encodeURIComponent(this.accessToken))).then(res => res.json()).then(data => {\r\n      var _data$features;\r\n      if (mapbox) return (data == null ? void 0 : (_data$features = data.features) == null ? void 0 : _data$features.length) > 0 ? this.createLatLng(data.features[0].center.reverse()) : null;else return (data == null ? void 0 : data.length) > 0 ? this.createLatLng(parseFloat(data[0].lat), parseFloat(data[0].lon)) : null;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Adjust tile layer options for FHD or higher\r\n   * @param {Object} options Tile layer options\r\n   */\r\n  function adjustTileLayerOptions(options) {\r\n    if (options.detectRetina) {\r\n      if ((window.devicePixelRatio || window.screen.deviceXDPI / window.screen.logicalXDPI) > 1)\r\n        // Retina\r\n        return options; // To be handled by Leaflet\r\n      if (window.screen.width >= this.hdWidth && options.maxZoom > 0) {\r\n        let opts = Object.assign({}, options);\r\n        opts.tileSize = Math.floor(opts.tileSize / 2);\r\n        if (!opts.zoomReverse) {\r\n          opts.zoomOffset++;\r\n          opts.maxZoom--;\r\n        } else {\r\n          opts.zoomOffset--;\r\n          opts.minZoom++;\r\n        }\r\n        opts.minZoom = Math.max(0, opts.minZoom);\r\n        return opts;\r\n      }\r\n    }\r\n    return options;\r\n  }\r\n\r\n  /**\r\n   * Create map\r\n   * @param {HTMLElement} el HTML element\r\n   * @param {Object} data Map data\r\n   */\r\n  function createMap(el, data) {\r\n    el.dataset.ext = \"leaflet\";\r\n    let map = L.map(el, Object.assign({}, this.mapOptions, {\r\n        zoom: data.zoom || 10,\r\n        center: data.latlng\r\n      })),\r\n      urlTemplate,\r\n      tileLayerOptions;\r\n    if (data.service == \"mapbox\") {\r\n      urlTemplate = this.mapboxSettings.urlTemplate;\r\n      tileLayerOptions = this.mapboxSettings.tileLayerOptions;\r\n    } else {\r\n      urlTemplate = this.openstreetmapSettings.urlTemplate;\r\n      tileLayerOptions = this.adjustTileLayerOptions(this.openstreetmapSettings.tileLayerOptions);\r\n    }\r\n    L.tileLayer(urlTemplate, Object.assign({}, tileLayerOptions, {\r\n      accessToken: this.accessToken\r\n    })).addTo(map);\r\n    return map;\r\n  }\r\n\r\n  /**\r\n   * Create LatLng object\r\n   * @param {Array|number} latitude Latitude or a geographical point as an array of the form [Number, Number]\r\n   * @param {number} longitude Longitude\r\n   */\r\n  function createLatLng(latitude, longitude) {\r\n    return L.latLng(latitude, longitude);\r\n  }\r\n\r\n  /**\r\n   * Create marker\r\n   * @param {Object} data Map data\r\n   */\r\n  function createMarker(data) {\r\n    let marker = L.marker(data.latlng, Object.assign({}, this.markerOptions, {\r\n      title: String(data.title || \"\")\r\n    }));\r\n    if (data.icon) marker.setIcon(L.icon({\r\n      iconUrl: data.icon\r\n    }));\r\n    let desc = String(data.description || \"\").trim();\r\n    if (desc)\r\n      // Popup\r\n      marker.bindPopup(desc).openPopup();\r\n    if (data.useMarkerClusterer) {\r\n      data.markerClusterer.addLayer(marker);\r\n    } else {\r\n      marker.addTo(data.map);\r\n    }\r\n    if (data.useSingleMap && data.showAllMarkers) data.bounds.extend(data.latlng); // Extend bounds\r\n    return marker;\r\n  }\r\n\r\n  /**\r\n   * Create marker clusterer\r\n   * @param {Object} data Map data\r\n   */\r\n  function createMarkerClusterer(data) {\r\n    let markerClusterer = L.markerClusterGroup(Object.assign({}, this.markerClustererOptions));\r\n    data.map.addLayer(markerClusterer);\r\n    return markerClusterer;\r\n  }\r\n\r\n  /**\r\n   * Create bounds object\r\n   */\r\n  function createBounds() {\r\n    return L.latLngBounds();\r\n  }\r\n\r\n  /**\r\n   * Fit bounds\r\n   * @param {Object} data Map data\r\n   */\r\n  function fitBounds(data) {\r\n    if (data.map && data.bounds) data.map.fitBounds(data.bounds);\r\n  }\n\n  exports.accessToken = accessToken;\n  exports.adjustTileLayerOptions = adjustTileLayerOptions;\n  exports.createBounds = createBounds;\n  exports.createLatLng = createLatLng;\n  exports.createMap = createMap;\n  exports.createMarker = createMarker;\n  exports.createMarkerClusterer = createMarkerClusterer;\n  exports.fitBounds = fitBounds;\n  exports.geocode = geocode;\n  exports.hdWidth = hdWidth;\n  exports.mapOptions = mapOptions;\n  exports.mapboxSettings = mapboxSettings;\n  exports.markerClustererOptions = markerClustererOptions;\n  exports.markerOptions = markerOptions;\n  exports.openstreetmapSettings = openstreetmapSettings;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n})(this.ew.maps.leaflet = this.ew.maps.leaflet || {});\n"],"mappings":"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"}